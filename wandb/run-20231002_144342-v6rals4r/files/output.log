/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/loggers/wandb.py:396: UserWarning: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
  rank_zero_warn(
Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory /net/tscratch/people/plgmazurekagh/energy_efficient_ai/efficient_classification/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
  | Name      | Type              | Params
------------------------------------------------
0 | model     | threeDClassModel  | 22.5 M
1 | loss      | BCEWithLogitsLoss | 0
2 | accuracy  | BinaryAccuracy    | 0
3 | auroc     | BinaryAUROC       | 0
4 | f1        | BinaryF1Score     | 0
5 | precision | BinaryPrecision   | 0
6 | recall    | BinaryRecall      | 0
------------------------------------------------
22.5 M    Trainable params
0         Non-trainable params
22.5 M    Total params
90.142    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:432: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 128 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.


Epoch 0: 100%|██████████| 16/16 [00:02<00:00,  5.90it/s, v_num=ls4r, train_loss_step=0.564, train_acc_step=0.663, train_auroc_step=0.738, train_f1_step=0.677, train_precision_step=0.719, train_recall_step=0.640, val_loss=0.572, val_acc=0.635, val_auroc=0.766, val_f1=0.540, val_precision=0.801, val_recall=0.410, train_loss_epoch=0.661, train_acc_epoch=0.552, train_auroc_epoch=0.579, train_f1_epoch=0.559, train_precision_epoch=0.585, train_recall_epoch=0.539]

Epoch 1:  94%|█████████▍| 15/16 [00:01<00:00,  8.64it/s, v_num=ls4r, train_loss_step=0.521, train_acc_step=0.730, train_auroc_step=0.800, train_f1_step=0.735, train_precision_step=0.739, train_recall_step=0.733, val_loss=0.572, val_acc=0.635, val_auroc=0.766, val_f1=0.540, val_precision=0.801, val_recall=0.410, train_loss_epoch=0.661, train_acc_epoch=0.552, train_auroc_epoch=0.579, train_f1_epoch=0.559, train_precision_epoch=0.585, train_recall_epoch=0.539]


Epoch 3:  38%|███▊      | 6/16 [00:01<00:01,  5.99it/s, v_num=ls4r, train_loss_step=0.486, train_acc_step=0.750, train_auroc_step=0.835, train_f1_step=0.745, train_precision_step=0.770, train_recall_step=0.721, val_loss=0.487, val_acc=0.740, val_auroc=0.856, val_f1=0.789, val_precision=0.689, val_recall=0.924, train_loss_epoch=0.498, train_acc_epoch=0.737, train_auroc_epoch=0.818, train_f1_epoch=0.752, train_precision_epoch=0.763, train_recall_epoch=0.747]

Epoch 4:  19%|█▉        | 3/16 [00:00<00:02,  4.65it/s, v_num=ls4r, train_loss_step=0.439, train_acc_step=0.781, train_auroc_step=0.876, train_f1_step=0.794, train_precision_step=0.879, train_recall_step=0.725, val_loss=0.450, val_acc=0.769, val_auroc=0.904, val_f1=0.810, val_precision=0.715, val_recall=0.937, train_loss_epoch=0.455, train_acc_epoch=0.772, train_auroc_epoch=0.861, train_f1_epoch=0.781, train_precision_epoch=0.790, train_recall_epoch=0.776]

Epoch 5:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.408, train_acc_step=0.831, train_auroc_step=0.900, train_f1_step=0.832, train_precision_step=0.877, train_recall_step=0.801, val_loss=0.365, val_acc=0.865, val_auroc=0.938, val_f1=0.873, val_precision=0.866, val_recall=0.882, train_loss_epoch=0.399, train_acc_epoch=0.817, train_auroc_epoch=0.906, train_f1_epoch=0.823, train_precision_epoch=0.848, train_recall_epoch=0.804]

Epoch 5: 100%|██████████| 16/16 [00:02<00:00,  7.25it/s, v_num=ls4r, train_loss_step=0.378, train_acc_step=0.807, train_auroc_step=0.905, train_f1_step=0.821, train_precision_step=0.820, train_recall_step=0.822, val_loss=0.329, val_acc=0.888, val_auroc=0.960, val_f1=0.896, val_precision=0.878, val_recall=0.916, train_loss_epoch=0.354, train_acc_epoch=0.853, train_auroc_epoch=0.928, train_f1_epoch=0.861, train_precision_epoch=0.883, train_recall_epoch=0.840]
Epoch 6: 100%|██████████| 16/16 [00:01<00:00,  8.89it/s, v_num=ls4r, train_loss_step=0.319, train_acc_step=0.831, train_auroc_step=0.946, train_f1_step=0.840, train_precision_step=0.835, train_recall_step=0.853, val_loss=0.329, val_acc=0.888, val_auroc=0.960, val_f1=0.896, val_precision=0.878, val_recall=0.916, train_loss_epoch=0.354, train_acc_epoch=0.853, train_auroc_epoch=0.928, train_f1_epoch=0.861, train_precision_epoch=0.883, train_recall_epoch=0.840]
Validation: 0it [00:00, ?it/s]


Epoch 8:  44%|████▍     | 7/16 [00:01<00:01,  6.41it/s, v_num=ls4r, train_loss_step=0.218, train_acc_step=0.957, train_auroc_step=0.985, train_f1_step=0.956, train_precision_step=0.968, train_recall_step=0.946, val_loss=0.246, val_acc=0.933, val_auroc=0.983, val_f1=0.937, val_precision=0.933, val_recall=0.942, train_loss_epoch=0.264, train_acc_epoch=0.909, train_auroc_epoch=0.970, train_f1_epoch=0.913, train_precision_epoch=0.922, train_recall_epoch=0.906]

Epoch 9:   6%|▋         | 1/16 [00:00<00:09,  1.50it/s, v_num=ls4r, train_loss_step=0.239, train_acc_step=0.926, train_auroc_step=0.979, train_f1_step=0.929, train_precision_step=0.900, train_recall_step=0.964, val_loss=0.209, val_acc=0.948, val_auroc=0.990, val_f1=0.952, val_precision=0.931, val_recall=0.974, train_loss_epoch=0.228, train_acc_epoch=0.922, train_auroc_epoch=0.978, train_f1_epoch=0.926, train_precision_epoch=0.933, train_recall_epoch=0.921]

Epoch 10:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.167, train_acc_step=0.964, train_auroc_step=0.994, train_f1_step=0.964, train_precision_step=0.953, train_recall_step=0.977, val_loss=0.180, val_acc=0.962, val_auroc=0.994, val_f1=0.964, val_precision=0.954, val_recall=0.975, train_loss_epoch=0.205, train_acc_epoch=0.936, train_auroc_epoch=0.984, train_f1_epoch=0.940, train_precision_epoch=0.937, train_recall_epoch=0.944]

Epoch 10: 100%|██████████| 16/16 [00:02<00:00,  7.75it/s, v_num=ls4r, train_loss_step=0.145, train_acc_step=0.958, train_auroc_step=0.996, train_f1_step=0.960, train_precision_step=0.955, train_recall_step=0.965, val_loss=0.177, val_acc=0.944, val_auroc=0.994, val_f1=0.949, val_precision=0.908, val_recall=0.996, train_loss_epoch=0.163, train_acc_epoch=0.958, train_auroc_epoch=0.992, train_f1_epoch=0.959, train_precision_epoch=0.969, train_recall_epoch=0.951]
Epoch 11: 100%|██████████| 16/16 [00:01<00:00,  8.83it/s, v_num=ls4r, train_loss_step=0.183, train_acc_step=0.940, train_auroc_step=0.977, train_f1_step=0.940, train_precision_step=0.918, train_recall_step=0.963, val_loss=0.177, val_acc=0.944, val_auroc=0.994, val_f1=0.949, val_precision=0.908, val_recall=0.996, train_loss_epoch=0.163, train_acc_epoch=0.958, train_auroc_epoch=0.992, train_f1_epoch=0.959, train_precision_epoch=0.969, train_recall_epoch=0.951]
Validation: 0it [00:00, ?it/s]


Epoch 13:  44%|████▍     | 7/16 [00:01<00:01,  6.40it/s, v_num=ls4r, train_loss_step=0.101, train_acc_step=0.977, train_auroc_step=0.998, train_f1_step=0.978, train_precision_step=0.971, train_recall_step=0.986, val_loss=0.0985, val_acc=0.982, val_auroc=0.999, val_f1=0.983, val_precision=0.975, val_recall=0.992, train_loss_epoch=0.122, train_acc_epoch=0.971, train_auroc_epoch=0.997, train_f1_epoch=0.972, train_precision_epoch=0.974, train_recall_epoch=0.971]

Epoch 14:   6%|▋         | 1/16 [00:00<00:10,  1.43it/s, v_num=ls4r, train_loss_step=0.102, train_acc_step=0.992, train_auroc_step=0.995, train_f1_step=0.992, train_precision_step=0.985, train_recall_step=1.000, val_loss=0.0774, val_acc=0.993, val_auroc=1.000, val_f1=0.994, val_precision=0.992, val_recall=0.996, train_loss_epoch=0.105, train_acc_epoch=0.979, train_auroc_epoch=0.998, train_f1_epoch=0.980, train_precision_epoch=0.981, train_recall_epoch=0.979]

Epoch 15:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.0738, train_acc_step=0.994, train_auroc_step=1.000, train_f1_step=0.994, train_precision_step=0.988, train_recall_step=1.000, val_loss=0.068, val_acc=0.993, val_auroc=1.000, val_f1=0.994, val_precision=0.996, val_recall=0.992, train_loss_epoch=0.0859, train_acc_epoch=0.987, train_auroc_epoch=0.999, train_f1_epoch=0.987, train_precision_epoch=0.987, train_recall_epoch=0.989]

Epoch 15: 100%|██████████| 16/16 [00:02<00:00,  7.55it/s, v_num=ls4r, train_loss_step=0.0605, train_acc_step=0.988, train_auroc_step=1.000, train_f1_step=0.989, train_precision_step=1.000, train_recall_step=0.979, val_loss=0.0483, val_acc=0.998, val_auroc=1.000, val_f1=0.998, val_precision=0.996, val_recall=1.000, train_loss_epoch=0.0709, train_acc_epoch=0.991, train_auroc_epoch=1.000, train_f1_epoch=0.991, train_precision_epoch=0.992, train_recall_epoch=0.991]



Epoch 18:  50%|█████     | 8/16 [00:01<00:01,  7.20it/s, v_num=ls4r, train_loss_step=0.0484, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0365, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0533, train_acc_epoch=0.996, train_auroc_epoch=1.000, train_f1_epoch=0.996, train_precision_epoch=0.996, train_recall_epoch=0.996]


Epoch 20:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.0501, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.026, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0432, train_acc_epoch=0.996, train_auroc_epoch=1.000, train_f1_epoch=0.996, train_precision_epoch=0.997, train_recall_epoch=0.995]

Epoch 20: 100%|██████████| 16/16 [00:02<00:00,  7.39it/s, v_num=ls4r, train_loss_step=0.0278, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0212, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0366, train_acc_epoch=0.997, train_auroc_epoch=1.000, train_f1_epoch=0.997, train_precision_epoch=0.997, train_recall_epoch=0.997]



Epoch 23:  44%|████▍     | 7/16 [00:01<00:01,  6.49it/s, v_num=ls4r, train_loss_step=0.0258, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0177, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0289, train_acc_epoch=0.997, train_auroc_epoch=1.000, train_f1_epoch=0.997, train_precision_epoch=0.998, train_recall_epoch=0.997]

Epoch 24:  12%|█▎        | 2/16 [00:00<00:04,  2.99it/s, v_num=ls4r, train_loss_step=0.0215, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0153, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0262, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=1.000, train_recall_epoch=0.998]


Epoch 26:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.0252, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0122, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0228, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=0.998, train_recall_epoch=0.999]


Epoch 27: 100%|██████████| 16/16 [00:01<00:00,  9.10it/s, v_num=ls4r, train_loss_step=0.0194, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.0119, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0209, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=0.999, train_recall_epoch=1.000]




Epoch 31:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.0326, train_acc_step=0.994, train_auroc_step=1.000, train_f1_step=0.994, train_precision_step=0.988, train_recall_step=1.000, val_loss=0.00719, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0155, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=0.999, train_recall_epoch=0.999]

Epoch 32: 100%|██████████| 16/16 [00:01<00:00,  9.12it/s, v_num=ls4r, train_loss_step=0.0111, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00627, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0136, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=0.999, train_recall_epoch=1.000]


Epoch 34:  75%|███████▌  | 12/16 [00:01<00:00,  7.99it/s, v_num=ls4r, train_loss_step=0.0108, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00609, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0132, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=1.000, train_recall_epoch=0.999]



Epoch 37: 100%|██████████| 16/16 [00:01<00:00,  9.14it/s, v_num=ls4r, train_loss_step=0.0109, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00538, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0117, train_acc_epoch=0.999, train_auroc_epoch=1.000, train_f1_epoch=0.999, train_precision_epoch=0.999, train_recall_epoch=0.999]


Validation: 0it [00:00, ?it/s]






Epoch 45:   0%|          | 0/16 [00:00<?, ?it/s, v_num=ls4r, train_loss_step=0.00798, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00319, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.00872, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]








Epoch 52: 100%|██████████| 16/16 [00:01<00:00,  8.74it/s, v_num=ls4r, train_loss_step=0.00519, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00233, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.00579, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]



Epoch 55:  38%|███▊      | 6/16 [00:01<00:01,  5.41it/s, v_num=ls4r, train_loss_step=0.00543, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00218, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.0063, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]


Epoch 57: 100%|██████████| 16/16 [00:01<00:00,  9.11it/s, v_num=ls4r, train_loss_step=0.0082, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00196, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.00577, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]


Epoch 59:  81%|████████▏ | 13/16 [00:01<00:00,  7.81it/s, v_num=ls4r, train_loss_step=0.00424, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00197, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.00532, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]

Epoch 59: 100%|██████████| 16/16 [00:02<00:00,  7.27it/s, v_num=ls4r, train_loss_step=0.0056, train_acc_step=1.000, train_auroc_step=1.000, train_f1_step=1.000, train_precision_step=1.000, train_recall_step=1.000, val_loss=0.00231, val_acc=1.000, val_auroc=1.000, val_f1=1.000, val_precision=1.000, val_recall=1.000, train_loss_epoch=0.00518, train_acc_epoch=1.000, train_auroc_epoch=1.000, train_f1_epoch=1.000, train_precision_epoch=1.000, train_recall_epoch=1.000]