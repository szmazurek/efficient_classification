Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory /net/tscratch/people/plgmazurekagh/energy_efficient_ai/efficient_classification/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
  | Name      | Type              | Params
------------------------------------------------
0 | model     | threeDClassModel  | 22.5 M
1 | loss      | BCEWithLogitsLoss | 0
2 | accuracy  | BinaryAccuracy    | 0
3 | auroc     | BinaryAUROC       | 0
4 | f1        | BinaryF1Score     | 0
5 | precision | BinaryPrecision   | 0
6 | recall    | BinaryRecall      | 0
------------------------------------------------
22.5 M    Trainable params
0         Non-trainable params
22.5 M    Total params
90.142    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:432: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 128 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(

Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]
Epoch 0:   0%|          | 0/4 [00:00<?, ?it/s]

Epoch 1:   0%|          | 0/4 [00:00<?, ?it/s, v_num=gk5f, train_loss_step=0.728, train_acc_step=0.529, train_auroc_step=0.547, train_f1_step=0.548, train_precision_step=0.597, train_recall_step=0.507, val_loss=0.771, val_acc=0.567, val_auroc=0.614, val_f1=0.702, val_precision=0.570, val_recall=0.916, train_loss_epoch=0.750, train_acc_epoch=0.501, train_auroc_epoch=0.513, train_f1_epoch=0.495, train_precision_epoch=0.537, train_recall_epoch=0.461]

Epoch 2:   0%|          | 0/4 [00:00<?, ?it/s, v_num=gk5f, train_loss_step=0.717, train_acc_step=0.548, train_auroc_step=0.574, train_f1_step=0.556, train_precision_step=0.571, train_recall_step=0.542, val_loss=0.680, val_acc=0.583, val_auroc=0.675, val_f1=0.706, val_precision=0.583, val_recall=0.897, train_loss_epoch=0.717, train_acc_epoch=0.546, train_auroc_epoch=0.574, train_f1_epoch=0.562, train_precision_epoch=0.581, train_recall_epoch=0.546]



Epoch 4:   0%|          | 0/4 [00:00<?, ?it/s, v_num=gk5f, train_loss_step=0.655, train_acc_step=0.616, train_auroc_step=0.653, train_f1_step=0.639, train_precision_step=0.651, train_recall_step=0.628, val_loss=0.664, val_acc=0.598, val_auroc=0.724, val_f1=0.497, val_precision=0.828, val_recall=0.357, train_loss_epoch=0.673, train_acc_epoch=0.596, train_auroc_epoch=0.631, train_f1_epoch=0.612, train_precision_epoch=0.623, train_recall_epoch=0.603]
[rank: 0] Received SIGTERM: 15

Epoch 4:  25%|██▌       | 1/4 [00:28<01:24, 28.19s/it, v_num=gk5f, train_loss_step=0.656, train_acc_step=0.615, train_auroc_step=0.658, train_f1_step=0.638, train_precision_step=0.644, train_recall_step=0.632, val_loss=0.664, val_acc=0.598, val_auroc=0.724, val_f1=0.497, val_precision=0.828, val_recall=0.357, train_loss_epoch=0.673, train_acc_epoch=0.596, train_auroc_epoch=0.631, train_f1_epoch=0.612, train_precision_epoch=0.623, train_recall_epoch=0.603]