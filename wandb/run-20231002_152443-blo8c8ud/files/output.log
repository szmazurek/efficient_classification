Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory /net/tscratch/people/plgmazurekagh/energy_efficient_ai/efficient_classification/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
  | Name      | Type              | Params
------------------------------------------------
0 | model     | threeDClassModel  | 22.5 M
1 | loss      | BCEWithLogitsLoss | 0
2 | accuracy  | BinaryAccuracy    | 0
3 | auroc     | BinaryAUROC       | 0
4 | f1        | BinaryF1Score     | 0
5 | precision | BinaryPrecision   | 0
6 | recall    | BinaryRecall      | 0
------------------------------------------------
22.5 M    Trainable params
0         Non-trainable params
22.5 M    Total params
90.142    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
/net/tscratch/people/plgmazurekagh/energy_efficient_ai/energy_efficient_env/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:432: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 128 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(

Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]




Epoch 0:  88%|████████▊ | 14/16 [00:52<00:07,  3.78s/it, v_num=c8ud, train_loss_step=0.704, train_acc_step=0.555, train_auroc_step=0.579, train_f1_step=0.607, train_precision_step=0.587, train_recall_step=0.629]

Epoch 1:   0%|          | 0/16 [00:00<?, ?it/s, v_num=c8ud, train_loss_step=0.708, train_acc_step=0.590, train_auroc_step=0.585, train_f1_step=0.618, train_precision_step=0.604, train_recall_step=0.632, val_loss=0.676, val_acc=0.565, val_auroc=0.614, val_f1=0.549, val_precision=0.620, val_recall=0.497, train_loss_epoch=0.748, train_acc_epoch=0.537, train_auroc_epoch=0.535, train_f1_epoch=0.585, train_precision_epoch=0.558, train_recall_epoch=0.621]
[rank: 0] Received SIGTERM: 15

Epoch 1:   6%|▋         | 1/16 [00:20<05:04, 20.30s/it, v_num=c8ud, train_loss_step=0.712, train_acc_step=0.543, train_auroc_step=0.554, train_f1_step=0.587, train_precision_step=0.553, train_recall_step=0.624, val_loss=0.676, val_acc=0.565, val_auroc=0.614, val_f1=0.549, val_precision=0.620, val_recall=0.497, train_loss_epoch=0.748, train_acc_epoch=0.537, train_auroc_epoch=0.535, train_f1_epoch=0.585, train_precision_epoch=0.558, train_recall_epoch=0.621]